<!DOCTYPE html>
<html lang="pt-BR">

<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <meta http-equiv="X-UA-Compatible" content="ie=edge" />
  <title>Gestão de madeireira</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js"
    integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"
    integrity="sha512-pHVGpX7F/27yZ0ISY+VVjyULApbDlD0/X0rgGbTqCE7WFW5MezNTWG/dnhtbBuICzsd0WQPgpE4REBLv+UqChw=="
    crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  <!-- CSS files -->
  <link href="{{ url_for('static', filename='css/classes-proprias.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/tabler.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/tabler-flags.min.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/tabler-payments.min.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/tabler-vendors.min.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='css/demo.min.css') }}" rel="stylesheet" />
  <link href="{{ url_for('static', filename='images/favicon.png') }}" rel="icon" type="image/png" sizes="68x68">
  <link href="{{ url_for('static', filename='libs/quill/quill-1.3.7/quill.snow.css') }}" rel="stylesheet">

  <!-- DataTables CSS -->
  <link rel="stylesheet" href="https://cdn.datatables.net/1.13.4/css/dataTables.bootstrap5.min.css">
  <script src="{{ url_for('static', filename='libs/quill/quill-1.3.7/quill.min.js') }}"></script>

  <!-- Tom Select CSS -->
  <link href="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/css/tom-select.css" rel="stylesheet">

  <!-- Tom Select JS -->
  <script src="https://cdn.jsdelivr.net/npm/tom-select@2.2.2/dist/js/tom-select.complete.min.js"></script>

  <style>
    @import url('https://rsms.me/inter/inter.css');

    :root {
      --tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
    }

    body {
      font-feature-settings: "cv03", "cv04", "cv11";
    }
  </style>

</head>

<body class="d-flex flex-column bg-white">
  <script src="{{ url_for('static', filename='js/demo-theme.min.js') }}"></script>
  <div class="page">

    {% block conteudo %}

    {% endblock conteudo %}

  </div>

  <!-- Tabler Core -->
  <script src="{{ url_for('static', filename='libs/tom-select/tom-select.base.min.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/tabler.min.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/demo.min.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/sistema/utilitarios.js') }}" defer></script>
  <script src="{{ url_for('static', filename='js/sistema/mascaras_config.js') }}" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/cleave.js@1.6.0/dist/cleave.min.js" defer></script>

  <script src="{{ url_for('static', filename='libs/apexcharts/dist/apexcharts.min.js') }}" defer></script>

  <!-- Data tables -->
  <script src="https://cdn.datatables.net/1.13.4/js/jquery.dataTables.min.js" defer></script>
  <script src="https://cdn.datatables.net/1.13.4/js/dataTables.bootstrap5.min.js" defer></script>

  <!-- Fecha os alertas automaticamente -->
  <script>
    // Função para fechar o alerta
    function closeAlert(alert) {
      alert.classList.remove('show');
      setTimeout(function () {
        alert.remove();
      }, 150); // Tempo para permitir a transição do fade
    }

    // Seleciona todos os alertas
    const alerts = document.querySelectorAll('.meu-alerta');

    // Configura cada alerta para fechar após 10 segundos
    alerts.forEach(function (alert) {
      setTimeout(function () {
        closeAlert(alert);
      }, 10000); // 10000 milissegundos = 10 segundos
    });

    document.addEventListener('DOMContentLoaded', () => {

      // Seleciona todos os botões de visualizar arquivo
      const botoesVisualizar = document.querySelectorAll('.btn-visualizar-arquivo');

      botoesVisualizar.forEach((botao, index) => {
        botao.addEventListener('click', () => {

          const urlArquivo = botao.getAttribute('data-url');
          const conteudoArquivo = document.getElementById('conteudo-arquivo');

          // Remove conteúdo anterior
          conteudoArquivo.innerHTML = '';

          // Verifica se a URL foi gerada corretamente
          if (!urlArquivo) {
            conteudoArquivo.innerHTML = '<p>Erro: URL do arquivo não encontrada.</p>';
            return;
          }

          // Verifica a extensão do arquivo
          const extensao = urlArquivo.split('.').pop().toLowerCase().trim();

          if (['jpg', 'jpeg', 'png'].includes(extensao)) {
            // Exibe imagem
            const img = document.createElement('img');
            img.src = urlArquivo;
            img.alt = 'Visualização do Arquivo';
            img.style.maxWidth = '100%';
            img.style.height = 'auto';

            img.onerror = () => {
              conteudoArquivo.innerHTML = '<p>Erro ao carregar a imagem.</p>';
            };

            conteudoArquivo.appendChild(img);
          } else if (extensao === 'pdf') {
            // Exibe PDF
            const iframe = document.createElement('iframe');
            iframe.src = urlArquivo;
            iframe.style.width = '100%';
            iframe.style.height = '720px';
            iframe.setAttribute('frameborder', '0');

            iframe.onload = () => {
              console.log('PDF carregado com sucesso.');
            };

            iframe.onerror = () => {
              conteudoArquivo.innerHTML = '<p>Erro ao carregar o PDF.</p>';
            };

            conteudoArquivo.appendChild(iframe);
          } else {
            conteudoArquivo.innerHTML = '<p>Tipo de arquivo não suportado para visualização.</p>';
          }

          console.log('Finalizado processamento do clique do botão.');
        });
      });
    });

  </script>

</body>

</html>