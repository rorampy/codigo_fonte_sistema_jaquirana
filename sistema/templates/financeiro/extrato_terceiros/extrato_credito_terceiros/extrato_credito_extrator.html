{% extends 'estrutura/base.html' %}
{% block conteudo %}
{% include 'estrutura/header.html' %}

<div class="page-wrapper">

  <!-- Cabe√ßalho -->
  <div class="page-header d-print-none">
    <div class="container-xl">
      <div class="row g-2 align-items-center">
        <div class="col">
          <div class="page-pretitle text-muted">FINANCEIRO</div>
          <h2 class="page-title fw-bold display-6">EXTRATO DO EXTRATOR</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Conte√∫do -->
  <div class="page-body py-4">
    <div class="container-xl">

      <div class="row g-2 align-items-center mb-4">
        <div class="col-md-6 col-lg-4">
          <div class="card border shadow-sm rounded-3">
            <div class="card-body d-flex align-items-center">
              <span class="avatar bg-blue text-white me-3">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                  viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round"
                  stroke-linejoin="round"
                  class="icon icon-tabler icon-tabler-currency-dollar">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path
                    d="M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2" />
                  <path d="M12 3v3m0 12v3" />
                </svg>
              </span>
              <div>
                <div class="text-uppercase text-muted fw-semibold small">Saldo
                  Atual</div>
                <div class="fs-3 fw-bold text-blue">
                  {{ saldo | formatar_float_para_brl }}
                </div>
              </div>
            </div>
          </div>
        </div>

        {% if extrato %}
        <div class="col-auto ms-auto">
          <a href="{{ url_for('lancar_credito_extrator', id=extrator.id) }}"
            class="btn btn-outline-success d-flex align-items-center gap-1"
            data-bs-toggle="tooltip"
            data-bs-placement="top" title="Registrar cr√©dito">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
              viewBox="0 0 24 24" fill="none"
              stroke="currentColor" stroke-width="2" stroke-linecap="round"
              stroke-linejoin="round"
              class="icon icon-tabler icon-tabler-plus">
              <path stroke="none" d="M0 0h24v24H0z" fill="none" />
              <path d="M12 5l0 14" />
              <path d="M5 12l14 0" />
            </svg>
            Lan√ßar Cr√©dito
          </a>
        </div>
        {% endif %}

      </div>

      {% if extrato %}
      <!-- EXTRATO DETALHADO -->
      <div class="card shadow-sm border-0 rounded-3">
        <!-- Cabe√ßalho com nome do extrator e bot√£o -->
        <div
          class="card-header bg-white border-bottom d-flex justify-content-between align-items-center px-4 py-3">
          <div>
            <span class="text-muted small text-uppercase">Extrator</span>
            <h4 class="fw-bold mb-0">{{ extrator.identificacao }}</h4>
          </div>
        </div>

        <div class="card-body p-0">

          <ul class="list-group list-group-flush">
            {% for e in extrato %}
            <li class="list-group-item py-3 px-4">
              <div class="d-flex justify-content-between align-items-center">
                <div class="d-flex align-items-center gap-3">

                  {% if e.tipo_movimentacao == 2 %}
                  <span class="text-danger">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24"
                      height="24" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round"
                      class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-down">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                      <path d="M12 5l0 14" />
                      <path d="M18 13l-6 6" />
                      <path d="M6 13l6 6" />
                    </svg>
                  </span>
                  {% elif e.tipo_movimentacao == 1 %}
                  <span class="text-success">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24"
                      height="24" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round"
                      class="icon icon-tabler icons-tabler-outline icon-tabler-arrow-up">
                      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                      <path d="M12 5l0 14" />
                      <path d="M18 11l-6 -6" />
                      <path d="M6 11l6 -6" />
                    </svg>
                  </span>
                  {% elif e.tipo_movimentacao == 3 %}
                  <span class="text-success">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24"
                      height="24" viewBox="0 0 24 24" fill="none"
                      stroke="currentColor" stroke-width="2"
                      stroke-linecap="round" stroke-linejoin="round"
                      class="icon icon-tabler icons-tabler-outline icon-tabler-x"><path
                        stroke="none" d="M0 0h24v24H0z" fill="none" /><path
                        d="M18 6l-12 12" /><path d="M6 6l12 12" /></svg>
                  </span>
                  {% elif e.tipo_movimentacao == 4 %}
                  <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
                    viewBox="0 0 24 24" fill="none" stroke="currentColor"
                    stroke-width="2" stroke-linecap="round"
                    stroke-linejoin="round"
                    class="icon icon-tabler icons-tabler-outline icon-tabler-currency-dollar"><path
                      stroke="none" d="M0 0h24v24H0z" fill="none" /><path
                      d="M16.7 8a3 3 0 0 0 -2.7 -2h-4a3 3 0 0 0 0 6h4a3 3 0 0 1 0 6h-4a3 3 0 0 1 -2.7 -2" /><path
                      d="M12 3v3m0 12v3" /></svg>
                  {% endif %}

                  {# Descri√ß√£o e Data #}
                  <div>
                    <div class="fw-semibold">
                      {{ e.descricao if e.descricao else
                      'Movimenta√ß√£o registrada no sistema' }}
                    </div>
                    <small class="text-muted">
                      {{ e.data_movimentacao | formatar_data_para_brl }} ‚Ä¢
                      {%if e.tipo_movimentacao == 4%} Estorno
                      {%elif e.tipo_movimentacao == 1%} Entrada
                      {%elif e.tipo_movimentacao == 2%} Sa√≠da
                      {%endif%}
                    </small>
                  </div>
                </div>

                <div class="text-end">
                  {% set valor = e.valor_credito_100 or 0 %}
                  <div
                    class="{{ 'text-success' if e.tipo_movimentacao == 1 or e.tipo_movimentacao == 4 else 'text-danger' }} fw-bold">
                    {{ '+' if e.tipo_movimentacao == 1 or e.tipo_movimentacao == 4 else '-' }}
                    {{ valor | formatar_float_para_brl }}
                  </div>
                  <span
                    class="badge {{ 'bg-success-lt text-success' if e.tipo_movimentacao == 1 or e.tipo_movimentacao == 4 else 'bg-danger-lt text-danger' }}">
                    {%if e.tipo_movimentacao == 4%} Estorno
                    {%elif e.tipo_movimentacao == 1%} Entrada
                    {%elif e.tipo_movimentacao == 2%} Sa√≠da
                    {%endif%}
                  </span>
                </div>
              </div>
            </li>
            {% endfor %}
          </ul>

        </div>
      </div>
      {% else %}
      <div class="area-info-extrato" style="
      background-color: white;
      padding: 30px;
      border-radius: 10px;
      text-align: center;
      box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
    ">
        <div class="icon-extrato"
          style="font-size: 60px; color: #fc7801; margin-bottom: 15px">
          üìÑ
        </div>
        <h2 style="font-size: 22px; margin-bottom: 10px">
          Ainda n√£o h√° extratos dispon√≠veis
        </h2>
        <p>
          N√£o encontramos registros de extrato no momento. Volte mais tarde ou
          fa√ßa um lan√ßamento de cr√©dito.
        </p>
        <a href="{{ url_for('lancar_credito_extrator', id=extrator.id) }}"
          class="btn btn-outline-success">
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24"
            viewBox="0 0 24 24" fill="none"
            stroke="currentColor" stroke-width="2" stroke-linecap="round"
            stroke-linejoin="round"
            class="icon icon-tabler icons-tabler-outline icon-tabler-moneybag">
            <path stroke="none" d="M0 0h24v24H0z" fill="none" />
            <path
              d="M9.5 3h5a1.5 1.5 0 0 1 1.5 1.5a3.5 3.5 0 0 1 -3.5 3.5h-1a3.5 3.5 0 0 1 -3.5 -3.5a1.5 1.5 0 0 1 1.5 -1.5" />
            <path
              d="M4 17v-1a8 8 0 1 1 16 0v1a4 4 0 0 1 -4 4h-8a4 4 0 0 1 -4 -4" />
          </svg> Lan√ßar Cr√©dito
        </a>
      </div>
      {% endif %}

      <div class="text-end mt-4 mb-5">
        <a href="{{ url_for('saldo_extratores') }}"
          class="btn btn-primary px-4 py-2 d-inline-flex align-items-center gap-2">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20"
            viewBox="0 0 24 24" stroke-width="2"
            stroke="currentColor" fill="none" stroke-linecap="round"
            stroke-linejoin="round">
            <path stroke="none" d="M0 0h24v24H0z" fill="none"></path>
            <path d="M5 12l14 0"></path>
            <path d="M5 12l6 6"></path>
            <path d="M5 12l6 -6"></path>
          </svg>
          Voltar
        </a>
      </div>

    </div>
  </div>

  {% include 'estrutura/footer.html' %}
</div>
{% endblock conteudo %}