{% extends 'estrutura/base.html' %}
{% block conteudo %}
{% include 'estrutura/header.html' %}
<link rel="stylesheet" href="{{url_for('static', filename='css/precificacao_mbr.css')}}">
<div class="page-wrapper">

  <div class="page-body">
    <div class="container-xl">
      {% include 'estrutura/mensagens_flash.html' %}

      <div class="row">
        <div class="col-12">
          <div class="mbr-card">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-christmas-tree">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M12 3l4 4l-2 1l4 4l-3 1l4 4h-14l4 -4l-3 -1l4 -4l-2 -1z" />
                  <path d="M14 17v3a1 1 0 0 1 -1 1h-2a1 1 0 0 1 -1 -1v-3" />
                </svg>
                Dados do Produto
              </h3>
            </div>
            <div class="mbr-card-body">
              <div class="mbr-section">
                <div class="mbr-section-title">Configuração Principal</div>
                <div class="row">
                  <div class="mb-3">
                    <div class="col-md-6">
                      <label class="mbr-form-label required">Produto Madeira Posta?</label>
                      <div>
                        <label class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="madeira_posta" value="sim"
                            id="madeira-posta-sim">
                          <span class="form-check-label">Sim</span>
                        </label>
                        <label class="form-check form-check-inline">
                          <input class="form-check-input" type="radio" name="madeira_posta" value="nao"
                            id="madeira-posta-nao">
                          <span class="form-check-label">Não</span>
                        </label>
                      </div>
                    </div>
                  </div>
                </div>
              </div>

              <div class="mbr-section">
                <div class="mbr-section-title">Serviços Opcionais</div>
                <div class="row">
                  <div class="col-md-6 mb-3">
                    <label class="form-check form-switch form-switch-3">
                      <input class="form-check-input" type="checkbox" id="switch-extracao" checked>
                      <span class="form-check-label">Incluir Serviço de Extração</span>
                    </label>
                  </div>
                  <div class="col-md-6 mb-3">
                    <label class="form-check form-switch form-switch-3">
                      <input class="form-check-input" type="checkbox" id="switch-comissao" checked>
                      <span class="form-check-label">Incluir Comissão de Venda</span>
                    </label>
                  </div>
                </div>
              </div>

              <div class="mbr-section">
                <div class="mbr-section-title">Especificações</div>
                <div class="row">
                  <div class="col-12 col-md-12 col-lg-3 mb-3">
                    <label class="mbr-form-label required">Produto</label>
                    <select class="form-select" id="select-produto">
                      <option value="">Selecione um produto...</option>
                      {% for produto in produtos %}
                      <option value="{{ produto.nome }}">{{ produto.nome }}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="col-12 col-md-12 col-lg-3 mb-3">
                    <label class="mbr-form-label required">Bitola</label>
                    <select class="form-select" id="select-bitola">
                      <option value="">Selecione uma bitola...</option>
                      {% for bitola in bitolas %}
                      <option value="{{ bitola.bitola }}">{{ bitola.bitola }}</option>
                      {% endfor %}
                    </select>
                  </div>
                  <div class="col-12 col-md-12 col-lg-3 mb-3">
                    <label class="mbr-form-label required">Valor Venda</label>
                    <div class="mbr-currency">
                      <input type="text" class="form-control campo-moeda-brl">
                    </div>
                  </div>
                  <div class="col-12 col-md-12 col-lg-3 mb-3">
                    <label class="mbr-form-label required">Quantidade (Ton)</label>
                    <input type="text" class="form-control campo-float">
                  </div>
                </div>
                <div class="mbr-card-total-area">
                  <div class="mbr-total-display">
                    <span class="mbr-total-label">Total Venda</span>
                    <span class="mbr-total-value">R$ 0,00</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        
        <div class="col-lg-12">
          <div class="mbr-card">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-trees">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M16 5l3 3l-2 1l4 4l-3 1l4 4h-9" />
                  <path d="M15 21l0 -3" />
                  <path d="M8 13l-2 -2" />
                  <path d="M8 12l2 -2" />
                  <path d="M8 21v-13" />
                  <path
                    d="M5.824 16a3 3 0 0 1 -2.743 -3.69a3 3 0 0 1 .304 -4.833a3 3 0 0 1 4.615 -3.707a3 3 0 0 1 4.614 3.707a3 3 0 0 1 .305 4.833a3 3 0 0 1 -2.919 3.695h-4z" />
                </svg>
                Compra de Mercadoria
              </h3>
            </div>
            <div class="mbr-card-body">
              <div class="row">
                
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Configuração Fiscal</div>
                    <div class="row">
                      <div class="col-12 col-md-12 col-lg-6">
                        <label class="mbr-form-label required">Emite Nota Fiscal?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_compra" value="sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_compra" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6" id="area-doc-fiscal-compra" style="display: none;">
                        <label class="mbr-form-label required">Haverá Ajuste Fiscal</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_compra" value="sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_compra" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6">
                        <label class="mbr-form-label required">Funrural/Senar</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="funrural" value="funrural" checked>
                            <span class="form-check-label">Funrural</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="funrural" value="senar">
                            <span class="form-check-label">Senar</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6" id="area-funrural-descontado">
                        <label class="mbr-form-label required">Funrural/Senar Descontado?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="funrural_descontado" value="sim" checked>
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="funrural_descontado" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-md-4 mb-3">
                      <label class="mbr-form-label required">Estado Origem</label>
                      <select class="form-select" id="select-estado-origem">
                        <option value="">Selecione...</option>
                        <option value="RS">RS</option>
                        <option value="SC">SC</option>
                      </select>
                    </div>
                    <div class="col-md-4 mb-3">
                      <label class="mbr-form-label required">Estado Destino</label>
                      <select class="form-select" id="select-estado-destino">
                        <option value="">Selecione...</option>
                        <option value="RS">RS</option>
                        <option value="SC">SC</option>
                      </select>
                    </div>
                    <div class="col-md-4 mb-3">
                      <label class="mbr-form-label required">Classificação Fiscal</label>
                      <select class="form-select" id="select-class-fiscal">
                        <option value="">Selecione...</option>
                        <option value="PR_PF">Produtor Rural PF</option>
                        <option value="PR_PJ_SIMPLES">Produtor Rural PJ Simples</option>
                        <option value="PR_PJ_REAL">Produtor Rural PJ Real/Presumido</option>
                        <option value="PJ_SIMPLES">Empresa PJ Simples</option>
                        <option value="PJ_REAL">Empresa PJ Real/Presumido</option>
                      </select>
                    </div>
                    <div class="col-md-12">
                      <label class="mbr-form-label required">Valor Compra (R$/Ton)</label>
                      <div class="mbr-currency">
                        <input type="text" class="form-control campo-moeda-brl" id="input-valor-ton-compra">
                      </div>
                    </div>
                  </div>
                </div>

                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Impostos e Acréscimos Aplicados</div>

                    <div id="area-impostos" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">ICMS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-icms" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">PIS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-pis" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">COFINS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-cofins" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3" id="area-funrural-com-nota" style="display: none;">
                          <label class="mbr-form-label">Funrural/Senar <span id="percent-funrural-com-nota"
                              style="color: #6c757d; font-size: 0.875rem;"></span></label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-funrural-com-nota" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-acrescimos" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-6">
                          <label class="mbr-form-label">Acréscimo Ajuste Fiscal (5%)</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-sem-nota" readonly>
                          </div>
                        </div>
                        <div class="col-6" id="area-funrural-sem-nota" style="display: none;">
                          <label class="mbr-form-label">Funrural/Senar <span id="percent-funrural-sem-nota"
                              style="color: #6c757d; font-size: 0.875rem;"></span></label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-funrural-sem-nota" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-sem-impostos">
                      <div class="text-center p-4"
                        style="background: #f8f9fa; border-radius: 6px; border: 1px dashed #dee2e6;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="icon icon-tabler icons-tabler-outline icon-tabler-info-circle mb-2"
                          style="color: var(--mbr-gray);">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                          <path d="M12 9h.01" />
                          <path d="M11 12h1v4h1" />
                        </svg>
                        <p class="mb-0" style="color: var(--mbr-gray); font-size: 0.875rem;">
                          Configure as opções ao lado para visualizar os impostos e acréscimos aplicados
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mbr-card-total-area">
                <div class="mbr-total-display">
                  <span class="mbr-total-label">Total Compra de mercadoria</span>
                  <span class="mbr-total-value">R$ 0,00</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row" id="row-servicos">
        
        <div class="col-lg-12" id="card-frete">
          <div class="mbr-card">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-truck">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M7 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                  <path d="M17 17m-2 0a2 2 0 1 0 4 0a2 2 0 1 0 -4 0" />
                  <path d="M5 17h-2v-11a1 1 0 0 1 1 -1h9v12m-4 0h6m4 0h2v-6h-8m0 -5h5l3 5" />
                </svg>
                Frete
              </h3>

            </div>
            <div class="mbr-card-body">
              <div class="row">
                
                <div class="col-12 col-md-12 col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Configuração Fiscal</div>
                    <div class="row">
                      <div class="col-12 col-md-12 col-lg-6">
                        <label class="mbr-form-label required">Emite Nota?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_frete" value="sim"
                              id="radio-frete-sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_frete" value="nao"
                              id="radio-frete-nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6" id="area-doc-fiscal-frete" style="display: none;">
                        <label class="mbr-form-label required">Haverá Ajuste Fiscal?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_frete" value="sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_frete" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row mb-3">
                    <div class="col-6 mb-3">
                      <label class="mbr-form-label required">Origem</label>
                      <select class="form-select" id="select-origem-frete">
                        <option value="RS">RS</option>
                        <option value="SC">SC</option>
                      </select>
                    </div>
                    <div class="col-6 mb-3">
                      <label class="mbr-form-label required">Destino</label>
                      <select class="form-select" id="select-destino-frete">
                        <option value="RS">RS</option>
                        <option value="SC">SC</option>
                      </select>
                    </div>
                    <div class="col-12 col-md-12 col-lg-6">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Prestador</label>
                        <select class="form-select" id="select-prestador-frete">
                          <option value="">Selecione...</option>
                          <option value="PJ_SIMPLES">PJ Simples Nacional</option>
                          <option value="PJ_REAL">PJ Real/Presumido</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-12 col-md-12 col-lg-6">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Tipo de Nota</label>
                        <select class="form-select" id="select-tipo-nota-frete">
                          <option value="">Selecione...</option>
                          <option value="CTE">CTE</option>
                          <option value="SERVICO">Nota Serviço</option>
                        </select>
                      </div>
                    </div>
                  </div>

                  <div>
                    <label class="mbr-form-label required">Valor Frete (R$/Ton)</label>
                    <div class="mbr-currency">
                      <input type="text" class="form-control campo-moeda-brl" id="input-valor-frete">
                    </div>
                  </div>
                </div>
                
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Impostos e Acréscimos Aplicados</div>

                    <div id="area-impostos-frete" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">ICMS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-icms-frete" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">PIS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-pis-frete" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">COFINS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-cofins-frete" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-acrescimos-frete" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4">
                          <label class="mbr-form-label">Acréscimo Ajuste Fiscal (5%)</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-sem-nota-frete" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-sem-impostos-frete">
                      <div class="text-center p-4"
                        style="background: #f8f9fa; border-radius: 6px; border: 1px dashed #dee2e6;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="icon icon-tabler icons-tabler-outline icon-tabler-info-circle mb-2"
                          style="color: var(--mbr-gray);">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                          <path d="M12 9h.01" />
                          <path d="M11 12h1v4h1" />
                        </svg>
                        <p class="mb-0" style="color: var(--mbr-gray); font-size: 0.875rem;">
                          Configure as opções ao lado para visualizar os impostos e acréscimos aplicados
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mbr-card-total-area">
                <div class="mbr-total-display">
                  <span class="mbr-total-label">Total de Frete</span>
                  <span class="mbr-total-value">R$ 0,00</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-12" id="card-extracao">
          <div class="mbr-card mbr-card-compact">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-slice">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M3 19l15 -15l3 3l-6 6l2 2a14 14 0 0 1 -14 4" />
                </svg>
                Serviço de Extração
              </h3>
            </div>
            <div class="mbr-card-body">
              <div class="row">
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Configuração Fiscal</div>
                    <div class="row">
                      <div class="col-12 col-md-12 col-lg-6">
                        <label class="mbr-form-label required">Emite Nota?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_extracao" value="sim"
                              id="radio-extracao-sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_extracao" value="nao"
                              id="radio-extracao-nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6" id="area-doc-fiscal-extracao" style="display: none;">
                        <label class="mbr-form-label required">Haverá Ajuste Fiscal</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_extracao" value="sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_extracao" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-12 col-md-6" id="col-prestador-extracao">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Tipo de Prestador</label>
                        <select class="form-select" id="select-prestador-extracao">
                          <option value="">Selecione...</option>
                          <option value="PJ_SIMPLES">PJ Simples Nacional</option>
                          <option value="PJ_REAL">PJ Real/Presumido</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-12 col-md-6" id="col-valor-extracao">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Valor Extração (R$/Ton)</label>
                        <div class="mbr-currency">
                          <input type="text" class="form-control campo-moeda-brl" id="input-valor-extracao">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Impostos e Acréscimos Aplicados</div>

                    <div id="area-impostos-extracao" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">ICMS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-icms-extracao" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">PIS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-pis-extracao" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">COFINS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-cofins-extracao" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-acrescimos-extracao" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4">
                          <label class="mbr-form-label">Acréscimo Ajuste Fiscal (5%)</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-sem-nota-extracao" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-sem-impostos-extracao">
                      <div class="text-center p-4"
                        style="background: #f8f9fa; border-radius: 6px; border: 1px dashed #dee2e6;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="icon icon-tabler icons-tabler-outline icon-tabler-info-circle mb-2"
                          style="color: var(--mbr-gray);">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                          <path d="M12 9h.01" />
                          <path d="M11 12h1v4h1" />
                        </svg>
                        <p class="mb-0" style="color: var(--mbr-gray); font-size: 0.875rem;">
                          Configure as opções ao lado para visualizar os impostos e acréscimos aplicados
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mbr-card-total-area">
                <div class="mbr-total-display">
                  <span class="mbr-total-label">Total serviço de extração</span>
                  <span class="mbr-total-value">R$ 0,00</span>
                </div>
              </div>
            </div>
          </div>
        </div>

        <div class="col-lg-12" id="card-comissao">
          <div class="mbr-card mbr-card-compact">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-moneybag">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path
                    d="M9.5 3h5a1.5 1.5 0 0 1 1.5 1.5a3.5 3.5 0 0 1 -3.5 3.5h-1a3.5 3.5 0 0 1 -3.5 -3.5a1.5 1.5 0 0 1 1.5 -1.5" />
                  <path d="M4 17v-1a8 8 0 1 1 16 0v1a4 4 0 0 1 -4 4h-8a4 4 0 0 1 -4 -4" />
                </svg>
                Comissão de Venda
              </h3>
            </div>
            <div class="mbr-card-body">
              <div class="row">
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Configuração Fiscal</div>
                    <div class="row">
                      <div class="col-12 col-md-12 col-lg-6">
                        <label class="mbr-form-label required">Emite Nota?</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_comissao" value="sim"
                              id="radio-comissao-sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="emite_nota_comissao" value="nao"
                              id="radio-comissao-nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                      <div class="col-12 col-md-12 col-lg-6" id="area-doc-fiscal-comissao" style="display: none;">
                        <label class="mbr-form-label required">Haverá Ajuste Fiscal</label>
                        <div>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_comissao" value="sim">
                            <span class="form-check-label">Sim</span>
                          </label>
                          <label class="form-check form-check-inline">
                            <input class="form-check-input" type="radio" name="doc_fiscal_comissao" value="nao">
                            <span class="form-check-label">Não</span>
                          </label>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="row">
                    <div class="col-12 col-md-6" id="col-prestador-comissao">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Tipo de Prestador</label>
                        <select class="form-select" id="select-prestador-comissao">
                          <option value="">Selecione...</option>
                          <option value="PJ_SIMPLES">PJ Simples Nacional</option>
                          <option value="PJ_REAL">PJ Real/Presumido</option>
                        </select>
                      </div>
                    </div>
                    <div class="col-12 col-md-6" id="col-valor-comissao">
                      <div class="mb-3">
                        <label class="mbr-form-label required">Valor Comissão (R$/Ton)</label>
                        <div class="mbr-currency">
                          <input type="text" class="form-control campo-moeda-brl" id="input-valor-comissao">
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                
                <div class="col-lg-6">
                  <div class="mbr-field-group">
                    <div class="mbr-field-group-title">Impostos e Acréscimos Aplicados</div>

                    <div id="area-impostos-comissao" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">ICMS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-icms-comissao" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">PIS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-pis-comissao" readonly>
                          </div>
                        </div>
                        <div class="col-4 mb-3">
                          <label class="mbr-form-label">COFINS</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-cofins-comissao" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-acrescimos-comissao" style="display: none;">
                      <div class="row mb-3">
                        <div class="col-4">
                          <label class="mbr-form-label">Acréscimo Ajuste Fiscal (5%)</label>
                          <div class="mbr-currency">
                            <input type="text" class="form-control mbr-readonly" id="valor-sem-nota-comissao" readonly>
                          </div>
                        </div>
                      </div>
                    </div>

                    <div id="area-sem-impostos-comissao">
                      <div class="text-center p-4"
                        style="background: #f8f9fa; border-radius: 6px; border: 1px dashed #dee2e6;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none"
                          stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                          class="icon icon-tabler icons-tabler-outline icon-tabler-info-circle mb-2"
                          style="color: var(--mbr-gray);">
                          <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                          <path d="M3 12a9 9 0 1 0 18 0a9 9 0 0 0 -18 0" />
                          <path d="M12 9h.01" />
                          <path d="M11 12h1v4h1" />
                        </svg>
                        <p class="mb-0" style="color: var(--mbr-gray); font-size: 0.875rem;">
                          Configure as opções ao lado para visualizar os impostos e acréscimos aplicados
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="mbr-card-total-area">
                <div class="mbr-total-display">
                  <span class="mbr-total-label">Total comissão de venda</span>
                  <span class="mbr-total-value">R$ 0,00</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="row">
        <div class="col-12">
          <div class="mbr-card">
            <div class="mbr-card-header">
              <h3 class="mbr-card-title">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none"
                  stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                  class="icon icon-tabler icons-tabler-outline icon-tabler-calculator">
                  <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                  <path d="M4 3m0 2a2 2 0 0 1 2 -2h10a2 2 0 0 1 2 2v14a2 2 0 0 1 -2 2h-10a2 2 0 0 1 -2 -2z" />
                  <path d="M8 7m0 1a1 1 0 0 1 1 -1h4a1 1 0 0 1 1 1v1a1 1 0 0 1 -1 1h-4a1 1 0 0 1 -1 -1z" />
                  <path d="M8 14l0 .01" />
                  <path d="M12 14l0 .01" />
                  <path d="M16 14l0 .01" />
                  <path d="M8 17l0 .01" />
                  <path d="M12 17l0 .01" />
                  <path d="M16 17l0 .01" />
                </svg>
                Análise Completa de Precificação
              </h3>
              <div class="mbr-card-total" id="total-receita-bruta">
                <span class="mbr-card-total-label">Receita Bruta</span>
                R$ 0,00
              </div>
            </div>
            <div class="mbr-card-body">
              
              <div class="mbr-section">
                <div class="mbr-section-title">Resumo de Impostos por Operação</div>
                <div class="creditos-table-container">
                  <table class="creditos-table">
                    <thead>
                      <tr>
                        <th>Operação</th>
                        <th>ICMS</th>
                        <th>PIS</th>
                        <th>COFINS</th>
                        <th>Total</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="credito-label">Venda de Mercadoria</td>
                        <td class="credito-valor" id="operacao-venda-icms">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-venda-pis">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-venda-cofins">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-venda-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Compra de Mercadoria</td>
                        <td class="credito-valor" id="operacao-compra-icms">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-compra-pis">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-compra-cofins">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-compra-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Frete</td>
                        <td class="credito-valor" id="operacao-frete-icms">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-frete-pis">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-frete-cofins">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-frete-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Extração</td>
                        <td class="credito-valor" id="operacao-extracao-icms">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-extracao-pis">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-extracao-cofins">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-extracao-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Comissão</td>
                        <td class="credito-valor" id="operacao-comissao-icms">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-comissao-pis">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-comissao-cofins">R$ 0,00</td>
                        <td class="credito-valor" id="operacao-comissao-total">R$ 0,00</td>
                      </tr>
                      <tr class="credito-total-row">
                        <td class="credito-total-label"><strong>Total Geral</strong></td>
                        <td class="credito-total-valor" id="total-geral-icms">R$ 0,00</td>
                        <td class="credito-total-valor" id="total-geral-pis">R$ 0,00</td>
                        <td class="credito-total-valor" id="total-geral-cofins">R$ 0,00</td>
                        <td class="credito-total-valor" id="total-geral-total">R$ 0,00</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="mbr-section">
                <div class="mbr-section-title">Custos com documentação - Ajuste Fiscal</div>
                <div class="creditos-table-container">
                  <table class="creditos-table">
                    <thead>
                      <tr>
                        <th>Operação</th>
                        <th>Descrição</th>
                        <th>Valor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="credito-label">Compra de Mercadoria</td>
                        <td class="credito-label" id="desc-acrescimo-compra">-</td>
                        <td class="credito-valor" id="acrescimo-compra-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Frete</td>
                        <td class="credito-label" id="desc-acrescimo-frete">-</td>
                        <td class="credito-valor" id="acrescimo-frete-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Extração</td>
                        <td class="credito-label" id="desc-acrescimo-extracao">-</td>
                        <td class="credito-valor" id="acrescimo-extracao-total">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Comissão</td>
                        <td class="credito-label" id="desc-acrescimo-comissao">-</td>
                        <td class="credito-valor" id="acrescimo-comissao-total">R$ 0,00</td>
                      </tr>
                      <tr class="credito-total-row">
                        <td class="credito-total-label"><strong>Total de Acréscimos</strong></td>
                        <td class="credito-total-label"><strong>Ajustes Fiscais</strong></td>
                        <td class="credito-total-valor" id="total-acrescimos-geral">R$ 0,00</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="mbr-section">
                <div class="mbr-section-title">Contribuições Sociais Rurais</div>
                <div class="creditos-table-container">
                  <table class="creditos-table">
                    <thead>
                      <tr>
                        <th>Operação</th>
                        <th>Descrição</th>
                        <th>Valor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="credito-label">Compra de Mercadoria</td>
                        <td class="credito-label" id="desc-funrural-compra">-</td>
                        <td class="credito-valor" id="funrural-compra-total">R$ 0,00</td>
                      </tr>
                      <tr class="credito-total-row">
                        <td class="credito-total-label"><strong>Total de Contribuições</strong></td>
                        <td class="credito-total-label"><strong>Funrural/Senar</strong></td>
                        <td class="credito-total-valor" id="total-funrural-geral">R$ 0,00</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <div class="mbr-section">
                <div class="mbr-section-title">Resumo Financeiro Completo</div>
                <div class="creditos-table-container">
                  <table class="creditos-table">
                    <thead>
                      <tr>
                        <th>Descrição</th>
                        <th>Valor</th>
                      </tr>
                    </thead>
                    <tbody>
                      <tr>
                        <td class="credito-label">Receita Bruta</td>
                        <td class="credito-valor" id="resumo-receita-bruta">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Total Impostos (Débito)</td>
                        <td class="credito-valor" id="resumo-impostos-debito">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Total Impostos (Crédito)</td>
                        <td class="credito-valor" id="resumo-impostos-credito">R$ 0,00</td>
                      </tr>
                      <tr class="mbr-highlight">
                        <td class="credito-label"><strong>Receita Líquida</strong></td>
                        <td class="credito-valor" id="resumo-receita-liquida">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">CMV</td>
                        <td class="credito-valor" id="resumo-cmv">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Lucro Bruto</td>
                        <td class="credito-valor" id="resumo-lucro-bruto">R$ 0,00</td>
                      </tr>
                      <tr class="mbr-highlight">
                        <td class="credito-label"><strong>Lucro Líquido</strong></td>
                        <td class="credito-valor" id="resumo-lucro-liquido">R$ 0,00</td>
                      </tr>
                      <tr>
                        <td class="credito-label">Margem (Ton)</td>
                        <td class="credito-valor" id="resumo-margem-ton">R$ 0,00</td>
                      </tr>
                      <tr class="credito-total-row">
                        <td class="credito-total-label"><strong>Margem Líquida</strong></td>
                        <td class="credito-total-valor" id="resumo-margem-liquida">0,00%</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <div class="mbr-section" style="border-top: 1px solid #eaeaea6b;">
        <div class="row">
          <div class="col-12 text-center">
            <form id="form-relatorio" method="POST" action="{{ url_for('simular_precificacao') }}" target="_blank"
              onsubmit="return prepararRelatorio()">

              <input type="hidden" name="produto" id="hidden-produto">
              <input type="hidden" name="bitola" id="hidden-bitola">
              <input type="hidden" name="valor_unitario" id="hidden-valor-unitario">
              <input type="hidden" name="quantidade" id="hidden-quantidade">
              <input type="hidden" name="madeira_posta" id="hidden-madeira-posta">

              <input type="hidden" name="emite_nota_compra" id="hidden-emite-nota-compra">
              <input type="hidden" name="doc_fiscal_compra" id="hidden-documentacao-fiscal-compra">
              <input type="hidden" name="funrural" id="hidden-funrural">
              <input type="hidden" name="funrural_descontado" id="hidden-funrural-descontado">
              <input type="hidden" name="estado_origem" id="hidden-estado-origem">
              <input type="hidden" name="estado_destino" id="hidden-estado-destino">
              <input type="hidden" name="classificacao_fiscal" id="hidden-classificacao-fiscal">
              <input type="hidden" name="valor_ton_compra" id="hidden-valor-ton-compra">

              <input type="hidden" name="emite_nota_frete" id="hidden-emite-nota-frete">
              <input type="hidden" name="origem_frete" id="hidden-origem-frete">
              <input type="hidden" name="destino_frete" id="hidden-destino-frete">
              <input type="hidden" name="prestador_frete" id="hidden-prestador-frete">
              <input type="hidden" name="tipo_nota_frete" id="hidden-tipo-nota-frete">
              <input type="hidden" name="valor_frete" id="hidden-valor-frete">
              <input type="hidden" name="doc_fiscal_frete" id="hidden-documentacao-fiscal-frete">

              <input type="hidden" name="emite_nota_extracao" id="hidden-emite-nota-extracao">
              <input type="hidden" name="prestador_extracao" id="hidden-prestador-extracao">
              <input type="hidden" name="valor_extracao" id="hidden-valor-extracao">
              <input type="hidden" name="doc_fiscal_extracao" id="hidden-documentacao-fiscal-extracao">

              <input type="hidden" name="emite_nota_comissao" id="hidden-emite-nota-comissao">
              <input type="hidden" name="prestador_comissao" id="hidden-prestador-comissao">
              <input type="hidden" name="valor_comissao" id="hidden-valor-comissao">
              <input type="hidden" name="doc_fiscal_comissao" id="hidden-documentacao-fiscal-comissao">

              <input type="hidden" name="tipo_relatorio" id="hidden-tipo-relatorio">

              <div class="d-flex justify-content-center gap-3 flex-wrap">
                <button type="button" class="mbr-btn-primary" onclick="gerarRelatorio('detalhado')"
                  style="padding: 12px 30px; font-size: 16px; font-weight: 600; border-radius: 8px; box-shadow: 0 2px 8px rgba(30, 86, 49, 0.2);">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="icon icon-tabler icons-tabler-outline icon-tabler-file-text" style="margin-right: 8px;">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                    <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                    <path d="M9 9l1 0" />
                    <path d="M9 13l6 0" />
                    <path d="M9 17l6 0" />
                  </svg>
                  Relatório Detalhado
                </button>

                <button type="button" class="mbr-btn-primary" onclick="gerarRelatorio('simplificado')"
                  style="padding: 12px 30px; font-size: 16px; font-weight: 600; border-radius: 8px; box-shadow: 0 2px 8px rgba(108, 117, 125, 0.2); background-color: #6c757d; border-color: #6c757d; color: white;">
                  <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="icon icon-tabler icons-tabler-outline icon-tabler-file-summary" style="margin-right: 8px;">
                    <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                    <path d="M14 3v4a1 1 0 0 0 1 1h4" />
                    <path d="M17 21h-10a2 2 0 0 1 -2 -2v-14a2 2 0 0 1 2 -2h7l5 5v11a2 2 0 0 1 -2 2z" />
                    <path d="M9 9l1 0" />
                    <path d="M9 13l3 0" />
                    <path d="M9 17l3 0" />
                  </svg>
                  Relatório Simplificado
                </button>
              </div>

              <div class="mt-3">
                <small class="text-muted d-block mb-1">
                  <strong>Detalhado:</strong> Relatório completo com gráficos, análise fiscal e breakdown detalhado
                </small>
                <small class="text-muted d-block">
                  <strong>Simplificado:</strong> Resumo executivo focado nos principais indicadores financeiros
                </small>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
  </div>

  {% include 'estrutura/footer.html' %}
  <script src="{{url_for('static', filename='js/sistema/precificacao_mbr.js')}}"></script>
</div>
</div>
{% endblock conteudo %}